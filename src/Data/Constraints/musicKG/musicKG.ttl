@prefix ex: <http://example.org/> .
@prefix exS: <http://example.org/shapes/> .
@prefix sh: <http://www.w3.org/ns/shacl#> .

exS:BeatlesAlbumGenreConstraint a sh:NodeShape ;
    sh:sparql [ sh:select """
     SELECT ($this AS ?this)
            WHERE {
                <http://example.org/The_Beatles> <http://example.org/hasAlbum> $this .
                FILTER NOT EXISTS {
                    $this <http://example.org/isGenre> <http://example.org/Rock> .
                }
            }
""" ] ;
    sh:targetClass ex:Album.



exS:SongAlbumGenreConstraint a sh:NodeShape ;
    sh:sparql [ sh:select """
     SELECT ($this AS ?this)
            WHERE {
                $this <http://example.org/includedIn> ?album .
                $this <http://example.org/isGenre> ?genre .
                FILTER NOT EXISTS {
                    ?album <http://example.org/isGenre> ?genre .
                }
            }
""" ] ;
    sh:targetClass ex:Song.
